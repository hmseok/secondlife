-- ================================================================
-- Self-Disruption ERP: 감가율 기준표 2026년 최신화
-- 029_depreciation_rates_update_2026.sql
-- ================================================================
-- 변경 내용:
--   1) 내연기관 잔존율 소폭 조정 (2025~26 중고차 시장 데이터 반영)
--   2) 전기차 차급별 세분화 (기존 중형_세단 1행 → 차급별 확장)
--   3) 하이브리드 차급별 세분화 (기존 중형_세단 1행 → 차급별 확장)
--   4) 전기차 잔존율 현실화 (초기 감가 반영, 3~5년 안정화 반영)
--
-- 참고 데이터: 엔카, KB차차차, K Car, GetCha 2025~2026 실거래 기반
-- ON CONFLICT UPSERT로 기존 행 안전 갱신
-- ================================================================


-- ================================================================
-- [1] 내연기관 — 소폭 조정
-- ================================================================
INSERT INTO depreciation_rates (origin, vehicle_class, fuel_type, rate_1yr, rate_2yr, rate_3yr, rate_4yr, rate_5yr, description) VALUES

-- ── 국산 내연기관 ─────────────────────────────────────
('국산', '경차',       '내연기관', 83.0, 73.0, 63.0, 53.0, 43.0, '모닝, 레이, 캐스퍼 — 실수요↑ 시장점유 +34% (2025)'),
('국산', '소형_세단',   '내연기관', 78.0, 65.0, 55.0, 45.0, 35.0, '아반떼, K3 — SUV 선호로 세단 수요 소폭↓'),
('국산', '준중형_세단', '내연기관', 76.0, 64.0, 54.0, 44.0, 34.0, '쏘나타, K5 — 볼륨 모델, 시장 기준선'),
('국산', '중형_세단',   '내연기관', 77.0, 66.0, 56.0, 46.0, 37.0, '그랜저, K8 — 중고차 인기 1위, 법인 수요 견조'),
('국산', '대형_세단',   '내연기관', 76.0, 64.0, 54.0, 44.0, 35.0, '제네시스 G80, G90 — 프리미엄 수요 증가'),
('국산', '소형_SUV',   '내연기관', 82.0, 72.0, 62.0, 52.0, 43.0, '셀토스, 코나 — 인기 유지, 변동 없음'),
('국산', '중형_SUV',   '내연기관', 80.0, 70.0, 60.0, 50.0, 41.0, '투싼, 스포티지, 싼타페 — 변동 없음'),
('국산', '대형_SUV',   '내연기관', 83.0, 73.0, 63.0, 53.0, 44.0, '팰리세이드, 쏘렌토 — 대기수요로 잔가 최상급'),
('국산', 'MPV',        '내연기관', 81.0, 71.0, 61.0, 51.0, 41.0, '카니발, 스타리아 — 판매량 +3.2%'),

-- ── 수입 내연기관 ─────────────────────────────────────
('수입', '중형_세단',   '내연기관', 73.0, 60.0, 50.0, 41.0, 34.0, '벤츠 C, BMW 3, 아우디 A4 — 렉서스 포함 소폭↑'),
('수입', '대형_세단',   '내연기관', 72.0, 58.0, 48.0, 40.0, 33.0, '벤츠 E, BMW 5 — 모델체인지 영향 반영'),
('수입', '중형_SUV',   '내연기관', 74.0, 62.0, 52.0, 43.0, 36.0, 'GLC, X3, Q5 — 변동 없음'),
('수입', '프리미엄',   '내연기관', 65.0, 50.0, 40.0, 33.0, 27.0, '벤츠 S, BMW 7, 포르쉐 — 급격 감가 유지')

ON CONFLICT (origin, vehicle_class, fuel_type) DO UPDATE SET
  rate_1yr = EXCLUDED.rate_1yr,
  rate_2yr = EXCLUDED.rate_2yr,
  rate_3yr = EXCLUDED.rate_3yr,
  rate_4yr = EXCLUDED.rate_4yr,
  rate_5yr = EXCLUDED.rate_5yr,
  description = EXCLUDED.description,
  updated_at = now();


-- ================================================================
-- [2] 전기차 — 차급별 세분화 + 잔존율 현실화
-- ================================================================
-- 핵심 변경:
--   - 1~2년차 초기 감가 반영 (배터리 불확실성 프리미엄)
--   - 3~5년차는 배터리 내구성 입증으로 안정화
--   - 아이오닉5 3년 잔존 53.4%, EV6 50~54% 실데이터 기반
--   - 테슬라 Model 3 3년 잔존 47.8%, Model Y 49.9%
-- ================================================================

INSERT INTO depreciation_rates (origin, vehicle_class, fuel_type, rate_1yr, rate_2yr, rate_3yr, rate_4yr, rate_5yr, description) VALUES

-- ── 국산 전기차 ─────────────────────────────────────
('국산', '소형_세단',  '전기', 73.0, 61.0, 51.0, 42.0, 34.0, 'EV3, 니로EV — 보급형 EV, 보조금 의존도 높음'),
('국산', '준중형_세단','전기', 74.0, 62.0, 52.0, 43.0, 35.0, '아이오닉5 SB, EV6 SB — 대중형 전기차'),
('국산', '중형_세단',  '전기', 75.0, 63.0, 53.0, 44.0, 36.0, '아이오닉5 LR, EV6 GT-line — 주력 모델, 잔존↑'),
('국산', '대형_세단',  '전기', 72.0, 59.0, 48.0, 39.0, 31.0, 'EV9, 제네시스 eG80 — 고가 EV, 초기 감가 큼'),
('국산', '소형_SUV',  '전기', 74.0, 62.0, 52.0, 43.0, 35.0, '코나 일렉트릭, EV4 — 실용형 전기 SUV'),
('국산', '중형_SUV',  '전기', 75.0, 63.0, 53.0, 44.0, 36.0, '아이오닉5, EV6 — SUV 매핑 동일'),
('국산', '대형_SUV',  '전기', 72.0, 59.0, 48.0, 39.0, 31.0, 'EV9 — 대형 전기 SUV'),

-- ── 수입 전기차 ─────────────────────────────────────
('수입', '중형_세단',  '전기', 67.0, 54.0, 44.0, 36.0, 29.0, '테슬라 Model 3/Y, 벤츠 EQA — 모델 주기 빠름'),
('수입', '대형_세단',  '전기', 63.0, 49.0, 39.0, 31.0, 25.0, '벤츠 EQE/EQS, BMW iX — 고가 수입EV 급감가'),
('수입', '중형_SUV',  '전기', 68.0, 55.0, 45.0, 37.0, 30.0, '테슬라 Model Y, 볼보 EX30/40'),
('수입', '프리미엄',  '전기', 60.0, 46.0, 36.0, 29.0, 23.0, '포르쉐 타이칸, BMW iX M60 — 프리미엄 EV 최대 감가')

ON CONFLICT (origin, vehicle_class, fuel_type) DO UPDATE SET
  rate_1yr = EXCLUDED.rate_1yr,
  rate_2yr = EXCLUDED.rate_2yr,
  rate_3yr = EXCLUDED.rate_3yr,
  rate_4yr = EXCLUDED.rate_4yr,
  rate_5yr = EXCLUDED.rate_5yr,
  description = EXCLUDED.description,
  updated_at = now();


-- ================================================================
-- [3] 하이브리드 — 차급별 세분화
-- ================================================================
-- 핵심: 하이브리드는 ICE 대비 동급 이상 잔존가
--   - 연비 강점 + 배터리 교체 리스크 낮음
--   - 그랜저HEV, 쏘렌토HEV 3년 감가 28~30%
-- ================================================================

INSERT INTO depreciation_rates (origin, vehicle_class, fuel_type, rate_1yr, rate_2yr, rate_3yr, rate_4yr, rate_5yr, description) VALUES

-- ── 국산 하이브리드 ────────────────────────────────────
('국산', '소형_세단',  '하이브리드', 80.0, 69.0, 59.0, 49.0, 40.0, '아반떼HEV, K3 HEV — 보급형 하이브리드'),
('국산', '준중형_세단','하이브리드', 82.0, 72.0, 62.0, 52.0, 43.0, '쏘나타HEV, K5 HEV — 대중형, 연비 우수'),
('국산', '중형_세단',  '하이브리드', 82.0, 72.0, 62.0, 52.0, 43.0, '그랜저HEV, K8 HEV — 법인수요↑, ICE 대비 잔존↑'),
('국산', '대형_세단',  '하이브리드', 78.0, 67.0, 57.0, 47.0, 38.0, '제네시스 G80e — 프리미엄 HEV'),
('국산', '소형_SUV',  '하이브리드', 83.0, 73.0, 63.0, 53.0, 44.0, '코나HEV, 니로HEV — 소형 하이브리드 SUV 인기↑'),
('국산', '중형_SUV',  '하이브리드', 83.0, 73.0, 63.0, 53.0, 44.0, '투싼HEV, 스포티지HEV, 싼타페HEV — 최고 인기'),
('국산', '대형_SUV',  '하이브리드', 84.0, 74.0, 64.0, 54.0, 45.0, '쏘렌토HEV, 팰리세이드HEV 예상 — 대기수요'),
('국산', 'MPV',       '하이브리드', 82.0, 72.0, 62.0, 52.0, 43.0, '카니발HEV — 연비형 MPV'),

-- ── 수입 하이브리드 ────────────────────────────────────
('수입', '중형_세단',  '하이브리드', 75.0, 63.0, 53.0, 44.0, 36.0, '캠리HEV, 렉서스 ES HEV — 내구성 우수'),
('수입', '중형_SUV',  '하이브리드', 76.0, 64.0, 54.0, 45.0, 37.0, '렉서스 NX, RAV4 HEV, X3 PHEV'),
('수입', '프리미엄',  '하이브리드', 68.0, 54.0, 44.0, 36.0, 29.0, '렉서스 RX/LS, 벤츠 S580e — 프리미엄 HEV')

ON CONFLICT (origin, vehicle_class, fuel_type) DO UPDATE SET
  rate_1yr = EXCLUDED.rate_1yr,
  rate_2yr = EXCLUDED.rate_2yr,
  rate_3yr = EXCLUDED.rate_3yr,
  rate_4yr = EXCLUDED.rate_4yr,
  rate_5yr = EXCLUDED.rate_5yr,
  description = EXCLUDED.description,
  updated_at = now();


-- ================================================================
-- 결과 확인 쿼리
-- ================================================================
-- SELECT origin, vehicle_class, fuel_type, rate_1yr, rate_2yr, rate_3yr, rate_4yr, rate_5yr, description
-- FROM depreciation_rates
-- WHERE is_active = true
-- ORDER BY fuel_type, origin, vehicle_class;
